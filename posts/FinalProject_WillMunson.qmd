---
title: "Final Project Vertical Farming"
author: "Will Munson"
date: "8/29/2022"
format:
  html:
    toc: true
    code-copy: true
    code-tools: true
---

For my final project, I will be looking at data related to soil health. This data will involve studying observations from numerous studies, and interpreting how the quality of soil has changed over the years. 
```{r}
#| label: setup
#| warning: false
#| message: false

library(tidyverse)
library(ggplot2)

knitr::opts_chunk$set(echo = TRUE, warning=FALSE, message=FALSE)
```

Vertical farming is set to be the future of farming and agriculture. While it won't replace traditional agriculture, it will make it so that farming can be done easily in urban areas, and without the need for extra land. This could also help reduce the need to transport goods across the country. Now, the dataset is a bit large, so I might have to limit the size of the data. 

```{r}
SoilHealth <- read_csv("_data/SoilHealthDB_V0.csv", show_col_types = FALSE)

SoilHealth
```

Now, this is a large dataset, and it'll require a lot of cleaning up in order to obtain the data we need. So, without further ado, let's get rid of some junk.

```{r}
SoilHealthFixed <- SoilHealth %>%
  select_if(~!(all(is.na(.)) | all(. == ""))) %>%
  select(-contains("Comments") & -contains("Author") & -contains("ClimateType") & -contains("Journal") & -contains("_C") & -contains("_T") & -contains("NoSubsample")) %>%
  filter(!is.na(Country)) %>%
  filter(!is.na(CoverCropGroup)) %>%
  filter(!is.na(GrainCropGroup)) %>%
  filter(!is.na(Texture)) %>%
  filter(!is.na(SamplingThickness)) %>%
  filter(!is.na(Duration)) %>%
  filter(!str_detect(CoverCropGroup, 'Not_available')) %>%
  filter(!str_detect(Texture, 'NotAvailable')) %>%
  filter(!str_detect(SamplingThickness, 'Not-available')) %>%
  mutate(SamplingThickness = as.double(SamplingThickness))
```

Alright, now, let's take a look at some bar graphs to see how each of these samples differ. Let's start with the crop cover groups that our soil has. 

```{r}
SoilHealthFixed %>%
  ggplot(aes(x = CoverCropGroup)) +
  geom_bar() +
  theme(axis.text.x = element_text(angle = 270))
```

As we can see here, the full majority of cover crops are within the legume group.

```{r}
SoilHealthFixed %>%
  ggplot(aes(x = GrainCropGroup)) +
  geom_bar() +
  theme(axis.text.x = element_text(angle = 270))
```

As expected, corn is the main grain crop group observed. I believe corn is used for more than just a food source, but also for livestock, starch, beverage and industrial alcohol, and fuel ethanol. That's why you see so much corn out here in the US. 

```{r}
SoilHealthFixed %>%
  ggplot(aes(x = Texture)) +
  geom_bar() +
  theme(axis.text.x = element_text(angle = 270))
```

The majority of the samples taken in this study were sandy loam or silty loam, or a mix of the three soil compositions, sand, silt and clay. 

Now let's take a look at which soil textures are most common with legumes AND corn. 

```{r}
SoilHealthFixed %>%
  filter(str_detect(CoverCropGroup, 'Legume')) %>%
  filter(str_detect(GrainCropGroup, 'Corn')) %>%
  ggplot(aes(x = Texture)) +
  geom_bar() +
  theme(axis.text.x = element_text(angle = 270))
```

So, here we notice that most environments where they grow both legumes and corn are in sandy loam, or loamy sand. This could indicate that both plants tend to grow in environments where water is more easily absorbed by the soil. 

Let's take a look at where these samples were studied too.
```{r}
SoilHealthFixed %>%
  ggplot(aes(x = Country)) +
  geom_bar() +
  theme(axis.text.x = element_text(angle = 270))
```

So, as expected, the full majority of our data was taken from 

```{r}
SoilHealthFixed %>%
  filter(!is.na(SoilpH)) %>%
  #filter(!is.na(Texture)) %>%
  #filter(str_detect(CoverCropGroup, 'Rye')) %>%
  #filter(str_detect(Country, 'USA')) %>%
  #filter(!str_detect(CoverCropGroup, 'Not_available')) %>%
  ggplot(aes(Texture, SoilpH)) +
  geom_boxplot() + 
  geom_hline(yintercept = 5.5, color = "red") +
  geom_hline(yintercept = 7.5, color = "red") +
  theme(axis.text.x = element_text(angle = 270))
```

Between the two red lines are the pH levels for healthy soils. As we can see here, we have one soil texture type that appears to be too acidic - silt. The other samples that were purely one texture - sand and clay - are right on the line of being too acidic. Perhaps this means most plants cannot handle soil that is purely silt. 

```{r}
SoilHealthFixed %>%
  ggplot(aes(Texture, SamplingThickness)) +
  geom_boxplot()
```

